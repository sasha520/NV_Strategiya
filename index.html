<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>NV_Strateliya</title>
<style>
body{margin:0;background:#1b1b1b;color:white;font-family:Arial;overflow:hidden;}
#ui{position:fixed;top:0;left:0;width:100%;background:#111;padding:8px;display:flex;gap:10px;align-items:center;z-index:10;}
button,input{background:#333;color:white;border:1px solid #666;padding:5px 10px;}
button:hover{background:#555;}
#money,#reserve{font-weight:bold;margin-left:10px;}
#map-wrapper{position:absolute;top:50px;left:0;right:0;bottom:0;overflow:hidden;}
#map{position:absolute;transform-origin:0 0;}
.tile{position:absolute;width:70px;height:70px;border-radius:8px;border:2px solid black;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:11px;cursor:pointer;}
.selected{outline:4px solid yellow;}
.Germany{background:#666;}
.France{background:#2f5eff;}
.USSR{background:#c0392b;}
.Austria{background:#aaa;color:black;}
.Romania{background:#f1c40f;color:black;}
.Yugoslavia{background:#27ae60;}
.Greece{background:#3498db;}
.UK{background:#8e44ad;}
.Spain{background:#e67e22;}
</style>
</head>
<body>
<div id="ui">
<input id="countryInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å—Ç—Ä–∞–Ω—É">
<button onclick="startGame()">–ù–∞—á–∞—Ç—å</button>
<button onclick="mode='inspect'">–ü–ª–∏—Ç–∫–∞</button>
<button onclick="mode='build'">–ó–∞–≤–æ–¥</button>
<button onclick="mode='deploy'">–†–∞–∑–º–µ—Å—Ç–∏—Ç—å</button>
<button onclick="mode='move'">–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å</button>
<button onclick="mode='attack'">–ê—Ç–∞–∫–æ–≤–∞—Ç—å</button>
<button onclick="zoom+=0.1;updateZoom()">+</button>
<button onclick="zoom-=0.1;updateZoom()">-</button>
<div id="money">üí∞ 0</div>
<div id="reserve">ü™ñ 0</div>
</div>

<div id="map-wrapper"><div id="map"></div></div>

<script>
let zoom=1,mode=null,playerCountry=null,money=0,reserve=0,selectedTile=null;
const map=document.getElementById("map");
const moneyEl=document.getElementById("money");
const reserveEl=document.getElementById("reserve");
const tiles=[];

function updateZoom(){map.style.transform=`scale(${zoom})`;}
function updateUI(){moneyEl.innerText="üí∞ "+money; reserveEl.innerText="ü™ñ "+reserve;}

function addTile(name,country,x,y,bot=true){
  const t={
    name,country,x,y,
    army:bot?5:0,
    factories:bot?1:0,
    maxFactories:bot?1:2
  };
  tiles.push(t);
  const el=document.createElement("div");
  el.className="tile "+country;
  el.style.left=x+"px";
  el.style.top=y+"px";
  el.innerHTML=`<b>${name}</b><span>ü™ñ ${t.army}</span>`;
  el.onclick=()=>onTileClick(t,el);
  t.el=el;
  map.appendChild(el);
}

function onTileClick(t,el){
  document.querySelectorAll(".tile").forEach(e=>e.classList.remove("selected"));
  el.classList.add("selected");

  if(mode==="inspect"){
    alert(`${t.name}\n${t.country}\n–ê—Ä–º–∏—è: ${t.army}\n–ó–∞–≤–æ–¥—ã: ${t.factories}/${t.maxFactories}`);
  }

  if(mode==="build" && t.country===playerCountry){
    if(t.factories<t.maxFactories && money>=5000){
      t.factories++; money-=5000; updateUI();
    } else alert("–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥ –∏–ª–∏ –º–∞–∫—Å–∏–º—É–º –∑–∞–≤–æ–¥–æ–≤ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç");
  }

  if(mode==="deploy" && t.country===playerCountry && reserve>0){
    let num=parseInt(prompt("–°–∫–æ–ª—å–∫–æ –∞—Ä–º–∏–∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –Ω–∞ —ç—Ç–æ–π –ø–ª–∏—Ç–∫–µ?", "0"));
    if(num>0 && num<=reserve){
      t.army+=num; reserve-=num;
      t.el.querySelector("span").innerText="ü™ñ "+t.army;
      updateUI();
    }
  }

  if(mode==="attack" && selectedTile && selectedTile!==t){
    if(selectedTile.army>t.army){
      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—Ä–º–∏–∏, –∫–æ—Ç–æ—Ä–æ–µ –æ—Å—Ç–∞–ª–æ—Å—å –ø–æ—Å–ª–µ –±–æ—è
      let remaining = selectedTile.army - t.army;
      t.country = playerCountry;
      t.army = remaining;
      t.factories = 0;
      t.maxFactories = 2;
      t.el.className = "tile " + playerCountry;
      t.el.querySelector("span").innerText = "ü™ñ " + t.army;

      // —É–±–∏—Ä–∞–µ–º —Å –∞—Ç–∞–∫—É—é—â–µ–π –ø–ª–∏—Ç–∫–∏ –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω—ã–µ –≤–æ–π—Å–∫–∞
      selectedTile.army = remaining;
      selectedTile.el.querySelector("span").innerText = "ü™ñ " + selectedTile.army;

      updateUI();
    } else alert("–í–∞—à–∞ –∞—Ä–º–∏—è —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±–∞—è!");
  }

  selectedTile = t;
}

function startGame(){
  const input=document.getElementById("countryInput").value.trim();
  const exists=tiles.some(t=>t.country===input);
  if(!exists){alert("–¢–∞–∫–æ–π —Å—Ç—Ä–∞–Ω—ã –Ω–µ—Ç");return;}
  playerCountry=input;
  tiles.forEach(t=>{
    if(t.country===playerCountry){
      t.army=0;
      t.factories=0;
      t.maxFactories=2;
      t.el.querySelector("span").innerText="ü™ñ 0";
    }
  });
  money=5000; reserve=0; updateUI();
}

// ===== –î–û–ë–ê–í–õ–ï–ù–ò–ï –ü–õ–ò–¢–û–ö =====
addTile("Berlin","Germany",300,200);
addTile("Hamburg","Germany",380,200);
addTile("Munich","Germany",340,280);

addTile("Paris","France",150,260);
addTile("Marseille","France",170,340);

addTile("Moscow","USSR",520,160);
addTile("Minsk","USSR",460,200);
addTile("Leningrad","USSR",520,100);
addTile("Kiev","USSR",470,260);

addTile("Vienna","Austria",320,320);
addTile("Bucharest","Romania",420,340);

addTile("Belgrade","Yugoslavia",350,360);
addTile("Zagreb","Yugoslavia",300,350);
addTile("Sarajevo","Yugoslavia",330,390);

addTile("Athens","Greece",380,430);
addTile("Thessaloniki","Greece",410,400);

addTile("London","UK",120,170);
addTile("Manchester","UK",120,120);

addTile("Madrid","Spain",80,350);
addTile("Barcelona","Spain",120,320);

// ===== –°–ï–ö–£–ù–î–ù–ê–Ø –õ–û–ì–ò–ö–ê =====
setInterval(()=>{
  let income = 0; // –¥–µ–Ω—å–≥–∏ –∑–∞ –ø–ª–∏—Ç–∫–∏
  let reserveIncrease = 0; // –≤–æ–π—Å–∫–∞ –≤ —Ä–µ–∑–µ—Ä–≤
  tiles.forEach(t=>{
    if(t.country!==playerCountry){ // –±–æ—Ç
      t.army+=1; 
      t.el.querySelector("span").innerText="ü™ñ "+t.army;
    } else if(t.country===playerCountry){
      income += 15; // –¥–æ—Ö–æ–¥ –∑–∞ –ø–ª–∏—Ç–∫—É
      reserveIncrease += t.factories; // 1 –∑–∞–≤–æ–¥ = 1 –≤–æ–π—Å–∫–æ –≤ —Ä–µ–∑–µ—Ä–≤
    }
  });
  money += income;
  reserve += reserveIncrease;
  updateUI();
},1000);
</script>
</body>
</html>
